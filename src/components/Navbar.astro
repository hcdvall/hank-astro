---
const links = [
  { href: "/home", label: "Home" },
  { href: "/about", label: "About" },
  { href: "/blog", label: "Blog" },
  { href: "/projects", label: "Projects" },
];
---
<nav class="navbar">
  <!-- Brand/Logo with glitch effect - positioned on the left -->
  <div class="navbar-brand">
    <a href="/">
      <h1 class="glitch-navbar" data-text="HENRIK_SEDVALL">HENRIK_SEDVALL</h1>
    </a>
  </div>

  <!-- Hamburger button - only visible on mobile -->
  <button class="hamburger" id="hamburger-btn" aria-label="Open menu">
    <span class="hamburger-line"></span>
    <span class="hamburger-line"></span>
  </button>
  
  <!-- Mobile menu - hidden by default, shown when hamburger is clicked -->
  <ul class="navbar-links-mobile" id="navbar-links">
    {links.map(link => (
      <li>
        <a href={link.href}>{link.label}</a>
      </li>
    ))}
    <li class="theme-toggle-mobile">
      <button id="theme-toggle-mobile" class="theme-toggle">
        <svg class="lamp-icon" width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
          <path d="M6.293,17.293l-3,3a1,1,0,0,0,1.414,1.414l3-3a1,1,0,0,0-1.414-1.414Z"/><path d="M20.707,20.293l-3-3a1,1,0,0,0-1.414,1.414l3,3a1,1,0,0,0,1.414-1.414Z"/><path d="M12,17a1,1,0,0,0-1,1v3a1,1,0,0,0,2,0V18A1,1,0,0,0,12,17Z"/><path d="M6,15H18a1,1,0,0,0,0-2H17V12a5,5,0,0,0-4.02-4.9A.826.826,0,0,0,13,7V3a1,1,0,0,0-2,0V7a.826.826,0,0,0,.02.1A5,5,0,0,0,7,12v1H6a1,1,0,0,0,0,2Z"/>
        </svg>
      </button>
    </li>
  </ul>

  <!-- Desktop menu - always visible on desktop, hidden on mobile -->
  <ul class="navbar-links-desktop">
    {links.map(link => (
      <li>
        <a href={link.href}>{link.label}</a>
      </li>
    ))}
    <li>
      <button id="theme-toggle-desktop" class="theme-toggle">
        <svg class="lamp-icon" width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
          <path d="M6.293,17.293l-3,3a1,1,0,0,0,1.414,1.414l3-3a1,1,0,0,0-1.414-1.414Z"/><path d="M20.707,20.293l-3-3a1,1,0,0,0-1.414,1.414l3,3a1,1,0,0,0,1.414-1.414Z"/><path d="M12,17a1,1,0,0,0-1,1v3a1,1,0,0,0,2,0V18A1,1,0,0,0,12,17Z"/><path d="M6,15H18a1,1,0,0,0,0-2H17V12a5,5,0,0,0-4.02-4.9A.826.826,0,0,0,13,7V3a1,1,0,0,0-2,0V7a.826.826,0,0,0,.02.1A5,5,0,0,0,7,12v1H6a1,1,0,0,0,0,2Z"/>
        </svg>
      </button>
    </li>
  </ul>
</nav>

<script>
  function toggleMenu(e) {
    const links = document.getElementById("navbar-links");
    if (links) {
      links.classList.toggle("open");
    }
  }

  function handleDocumentClick(e) {
    const btn = document.getElementById("hamburger-btn");
    const links = document.getElementById("navbar-links");
    if (
      links &&
      links.classList.contains("open") &&
      !links.contains(e.target) &&
      !btn.contains(e.target)
    ) {
      links.classList.remove("open");
    }
  }

  function initializeHamburgerMenu() {
    const btn = document.getElementById("hamburger-btn");
    if (btn) {
      btn.removeEventListener("click", toggleMenu);
      btn.addEventListener("click", toggleMenu);
    }
    document.removeEventListener("click", handleDocumentClick);
    document.addEventListener("click", handleDocumentClick);
  }

  document.addEventListener("DOMContentLoaded", initializeHamburgerMenu);
  document.addEventListener("astro:page-load", initializeHamburgerMenu);
</script>

<style>
  @font-face {
    font-family: 'VT323';
    src: url('/fonts/VT323-Regular.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
    font-display: swap;
  }
  @font-face {
    font-family: 'PressStart2P';
    src: url('/fonts/PressStart2P-Regular.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
    font-display: swap;
  }

  .navbar {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    max-width: 1140px;
    height: 40px;
    margin: 0 auto;
    padding: 1.5rem 3.2rem; 
    background-color: var(--navbar-background);
    color: var(--navbar-text-color);
    font-size: 1rem;
    font-family: var(--header-font);
    display: flex;
    justify-content: space-between; /* Space between brand and links */
    align-items: center;
    text-shadow: 0px 0px 3px var(--navbar-glow-color), 0px 0px 3px var(--navbar-glow-color);
    z-index: 1000;
    opacity: 0.95;
  }

  /* Navbar brand with glitch effect */
  .navbar-brand {
    flex-shrink: 0;
  }

  .glitch-navbar {
    font-size: 3.2rem;
    font-weight: bold;
    color: var(--dracula-cyan);
    position: relative;
    margin: 0;
    font-family: 'VT323', monospace;
    animation: glitch-navbar 3s infinite;
  }

  @keyframes glitch-navbar {
    0%, 100% { transform: translate(0); }
    20% { transform: translate(-1px, 1px); }
    40% { transform: translate(-1px, -1px); }
    60% { transform: translate(1px, 1px); }
    80% { transform: translate(1px, -1px); }
  }

  .glitch-navbar::before,
  .glitch-navbar::after {
    content: attr(data-text);
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }

  .glitch-navbar::before {
    animation: glitch-navbar-1 0.3s infinite;
    color: var(--dracula-pink);
    z-index: -1;
  }

  .glitch-navbar::after {
    animation: glitch-navbar-2 0.3s infinite;
    color: var(--dracula-purple);
    z-index: -2;
  }

  @keyframes glitch-navbar-1 {
    0%, 100% { transform: translate(0); }
    20% { transform: translate(-1px, 1px); }
    40% { transform: translate(-1px, -1px); }
    60% { transform: translate(1px, 1px); }
    80% { transform: translate(1px, -1px); }
  }

  @keyframes glitch-navbar-2 {
    0%, 100% { transform: translate(0); }
    20% { transform: translate(1px, -1px); }
    40% { transform: translate(1px, 1px); }
    60% { transform: translate(-1px, -1px); }
    80% { transform: translate(-1px, 1px); }
  }

  /* Make the brand clickable */
  .navbar-brand a {
    text-decoration: none;
    color: inherit;
  }

  /* Desktop links - horizontal layout, always visible on desktop */
  .navbar-links-desktop {
    display: none; /* Hidden on mobile by default */
    list-style: none;
    flex-direction: row;
    gap: 0.5rem; /* Reduced spacing as requested */
    margin: 0;
    padding: 0;
    align-items: center;
    margin-left: auto; /* Push to the right */
  }

  .navbar-links-desktop li {
    list-style: none;
  }

  .navbar-links-desktop a {
    color: var(--navbar-text-color);
    text-decoration: inherit;
    padding: 0.3em 0.8em;
    border-radius: 0.3em;
    transition: background-color 0.2s, transform 0.2s;
  }

  .navbar-links-desktop a:hover {
    background-color: var(--button-hover);
    transform: scale(1.05);
  }

  /* Mobile links - vertical dropdown, hidden by default */
  .navbar-links-mobile {
    list-style: none;
    display: none;
    flex-direction: column;
    gap: 1rem;
    margin: 0;
    padding: 2rem 1rem 1rem 1rem;
    width: 300px;
    max-width: 90vw;
    position: fixed;
    top: 0px;
    left: 50%;
    transform: translate(-50%, 0);
    background: var(--navbar-background);
    z-index: 999;
    align-items: center;
    text-align: center;
    border: 2px solid var(--content-border-color);
    border-radius: 0.5rem;
    box-shadow: 0 0 2px var(--navbar-glow-color);
  }

  .navbar-links-mobile.open {
    display: flex;
  }

  .navbar-links-mobile li {
    list-style: none;
  }

  .navbar-links-mobile a {
    color: var(--navbar-text-color);
    text-decoration: inherit;
    padding: 0.3em 0.3em;
    border-radius: 0.0em 0em 0.0em 0em;
    transition: background-color 0.2s, transform 0.2s;
  }

  .navbar-links-mobile a:hover {
    background-color: var(--button-hover);
    transform: scale(1.15);
    box-shadow: 0 0 0px var(--button-hover);
  }

  /* Hamburger button */
  .hamburger {
    display: block;
    font-size: 1rem;
    background: none;
    border: none;
    cursor: pointer;
    color: var(--text-color);
  }

  .hamburger-line {
    display: block;
    width: 32px;
    height: 4px;
    margin: 6px 0;
    background: var(--text-color);
    border-radius: 2px;
    transition: background 0.2s;
  }

  /* Theme toggle styles */
  .theme-toggle {
    background-color: var(--background-color);
    border: none;
    padding: 0.5rem 1rem;
    cursor: pointer;
    font-weight: bold;
    font-size: 20px;
  }

  .lamp-icon {
    color: var(--text-color);
    width: 32px;
    height: 32px;
  }

  .lamp-icon:hover {
    color: var(--the-yellow);
    transform: scale(1.2);
  }

  /* Media queries for responsive behavior */
  @media (min-width: 968px) {
    /* Desktop: Show desktop links, hide hamburger and mobile links */
    .navbar-links-desktop {
      display: flex;
    }
    
    .hamburger,
    .navbar-links-mobile {
      display: none !important;
    }
  }

  @media (max-width: 967px) {
    /* Mobile: Show hamburger, hide desktop links */
    .navbar-links-desktop {
      display: none !important;
    }
    
    .hamburger {
      display: block;
    }
  }

  @media (max-width: 700px) {
    .navbar {
      padding: 1.5rem 0.5rem;
      
    }
    .navbar-links-mobile {
      top: 1.0rem;
      max-width: none;
    }
  }
</style>